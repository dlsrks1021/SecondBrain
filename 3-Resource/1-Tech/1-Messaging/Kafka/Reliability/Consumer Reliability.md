컨슈머는 커밋된 메시지만 읽을 수 있다.
즉, 모든 ISR에 복제된 메시지만 처리 대상이 된다.

---

### 컨슈머의 책임

컨슈머의 핵심 책임은 다음 질문에 답하는 것이다.

- 어디까지 읽었는가?
- 어디부터 다시 시작해야 하는가?

이를 위해 컨슈머는 오프셋을 관리한다.

---

### 메시지 누락이 발생하는 경우

다음 상황에서 메시지 누락이 발생할 수 있다.

- 메시지는 읽었지만 처리 전에 오프셋을 커밋한 경우
- 컨슈머 크래시 직후 리밸런스 발생

---

### 주요 컨슈머 설정

group.id  
같은 그룹에 속한 컨슈머들은 파티션을 나눠 가진다.

auto.offset.reset  
earliest는 중복을 감수하고 유실을 줄인다.  
latest는 중복을 줄이지만 유실 위험이 있다.

enable.auto.commit  
자동 커밋은 중복 제어가 불가능하다.

auto.commit.interval.ms  
커밋 빈도와 중복 수 사이의 트레이드오프다.

---

### 명시적 오프셋 커밋 전략

- 메시지 처리 후 커밋
- 커밋 빈도 조절
- 정확한 오프셋 커밋
- 리밸런스 처리
- 필요 시 재시도
- 상태 저장이 필요한 경우 고려
